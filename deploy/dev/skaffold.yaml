apiVersion: skaffold/v2beta7
kind: Config
metadata:
    name: blockvisor-ui
build:
    tagPolicy:
        gitCommit: {}
    artifacts:
        - image: us-docker.pkg.dev/blockjoy-deployer/blockvisor-ui/blockvisor-ui-dev
          context: ./
          docker:
              buildArgs:
                  NEXT_PUBLIC_VERCEL_ENV: 'production'
                  NEXT_PUBLIC_SUPPORT_EMAIL: 'support@blockjoy.com'
                  NEXT_PUBLIC_API_URL: 'https://api.dev.blockjoy.com'
                  NEXT_PUBLIC_MQTT_URL: 'wss://mqtt.dev.blockjoy.com:8084/mqtt'
                  NEXT_PUBLIC_SHORT_SHA: '{{.SHORT_SHA}}'
                  NEXT_PUBLIC_MIXPANEL_TOKEN: 'ceb51f9e98426b77862cfd9478415a1c'
                  NEXT_PUBLIC_MIXPANEL_PROJECT_URL: 'https://app.dev.blockjoy.com/mp'
                  NEXT_PUBLIC_STRIPE_KEY: 'pk_test_51KfoP7B5ce1jJsfTc35yyT9MTS6mU8MkaENM5ve4B3DkGF2wj3jJlkkrdTevcV1VxAYfgxt6M924Zdq2OmzVHXQO00zGmzIKkQ'
                  NEXT_PUBLIC_PIPEDRIVE_API_KEY: '24adcdf4df23eb9af46f8505aceb6f0dd3080606'
        - image: us-docker.pkg.dev/blockjoy-deployer/blockvisor-ui/blockvisor-ui-testing
          context: ./
          docker:
              buildArgs:
                  NEXT_PUBLIC_VERCEL_ENV: 'production'
                  NEXT_PUBLIC_SUPPORT_EMAIL: 'support@blockjoy.com'
                  NEXT_PUBLIC_API_URL: 'https://api.testing.blockjoy.com'
                  NEXT_PUBLIC_MQTT_URL: 'wss://mqtt.testing.blockjoy.com:8084/mqtt'
                  NEXT_PUBLIC_SHORT_SHA: '{{.SHORT_SHA}}'
                  NEXT_PUBLIC_STRIPE_KEY: 'pk_test_51KfoP7B5ce1jJsfTc35yyT9MTS6mU8MkaENM5ve4B3DkGF2wj3jJlkkrdTevcV1VxAYfgxt6M924Zdq2OmzVHXQO00zGmzIKkQ'
                  NEXT_PUBLIC_PIPEDRIVE_API_KEY: '24adcdf4df23eb9af46f8505aceb6f0dd3080606'
    local:
        push: true
        useDockerCLI: true
        concurrency: 0
profiles:
    - name: dev
      deploy:
          kustomize:
              paths:
                  - ../kubernetes/dev
    - name: staging
      deploy:
          kustomize:
              paths:
                  - ../kubernetes/staging
    - name: testing
      deploy:
          kustomize:
              paths:
                  - ../kubernetes/testing
    - name: prod
      deploy:
          kustomize:
              paths:
                  - ../kubernetes/prod
